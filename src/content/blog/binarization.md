---
title: 'Introduction to OpenCV'
description: "Applying basics image processing operations in OpenCV with Python"
pubDate: 'Sep 28 2023'
heroImage: '/bambo_bin.jpg'
---
<style>
    p {
        text-align: justify;
    }
    a {
        color: cadetblue;
    }
</style>

In nutshell [OpenCV](https://en.wikipedia.org/wiki/OpenCV) is programming library used for computer-vision. Originally written in C++, OpenCV contains multiple bindins for most popular programming languages, like Java or Python. Within this post I will show You how to read, write, change color-scale and perform binarisation operation. For simplicity purpose I will use Python bindings for examples.

In Python we usually use so called virtual environment, to encapsulate project environment. In general there are many ways to create them, I will use [pyenv](https://github.com/pyenv/pyenv). Let's create new virtualenv, with name <i>opencv</i>
```python
pyenv virtualenv opencv
pyenv local opencv
```
Please note that in second line I switched currently used environment into newly created one. What is important, your environment is active ONLY in the current tab. To make sure that you're using right one, just type `pyenv version` (which prints its name). If you want to make this environment global, just type
```python
pyenv global opencv
```
In such case it will be always your default env. Last but not least we want to install openCV library. Package is called [opencv-python](https://github.com/opencv/opencv-python). We'll also need [matplotlib](https://github.com/matplotlib/matplotlib). We can simply use pip for installing those packages.
```python
pip install opencv-python matplotlib
pip freeze 
```
If you can see <i>opencv-python</i> (numpy is installed as peer dependency) and matplotlib as an output from `freeze` command, it means that you are on the right sight of the moon üåù. Well done!

Now it's a right time to meet hero of the episode - my dog called <i>Bambo</i> (2.5 years old pug üê∂). His picture will be used as testing material. By the way, a fun fact: standard image used for testing image processing algorithms is called [Lena](https://en.wikipedia.org/wiki/Lenna). Lena (swedish model) was depicted in Playboy magazine, in <i>November 1972</i>. In wiki article I've just linked You can find more information why actually this picture was chosen. Now let's get back to the specifics. Consider following code:
```python 
import cv2
from matplotlib import pyplot as plt

def rgb_hist(img):
    color = ('b','g','r')
    for i,col in enumerate(color):
        histr = cv2.calcHist([img],[i],None,[256],[0,256])
        plt.plot(histr,color = col)
        plt.xlim([0,256])
    plt.show()

def display_img(name, img):
    cv2.imshow(name,img)
    cv2.waitKey(0)
    cv2.destroyAllWindows()

img = cv2.imread('IMG_3158.jpg')
display_img('bambo',img)
rgb_hist(img)
```
What we can see here ? I've created 2 functions. First, one for calculating histogram of each channel. Typical colourful image contains 3 channels: Red, Green and Blue.  Each channel, in turn, consists of a matrix of pixels - smallest, uniform, indivisible fragments of the image. Those pixels undergo the phenomenon of synthesis. Usually pixel is written on 8-bits, it means its value varies from 0 to 255. An image is created through a process called [additive color synthesis](https://en.wikipedia.org/wiki/Additive_color). As a consequence we can calculate number of all possible colors - all possible combination of resulting pixel:

255 * 255 * 255 = 16 581 375

Almost 17 millions colors! In this color space pixel with compositial (0,0,0) results in black color (edge of [wall](https://en.wikipedia.org/wiki/Additive_color#/media/File:RGB_combination_on_wall.png)), in other hand (255,255,255) white (center of [wall](https://en.wikipedia.org/wiki/Additive_color#/media/File:RGB_combination_on_wall.png)). And now explaining histogram is piece of cake. It's nothing more like a plot, where on X axis we observe each possible pixel value from given channel (0-255), and on Y axis count of occurences. Second function is meant to display original image with its natural color scale (hints: <i>imshow</i> takes window name as its first argument and <i>waitKey</i> function awaits any key to be pressed to close the window). Below you can find images generated by the script. Now let's see what is the result of mentioned script.


<div style="display:flex;justify-content:space-around;">
    <img width="48%" src="/bambo_rgb.jpg" alt="bambo" />
    <img width="48%" src="/bambo_hist.png" alt="histogram" />
</div>

Take a look onto histogram and image. Pug is very specific dog, cause he contains mostly 2 colors black and silver (or sliver-like color, sometimes it's more like peachy). And this is exactly what is reflected in the histogram. First peak around (20,20,20) represents black parts of the dog, like flews or ears (remember that (0,0,0) is pure black ?). If you still don't belive me please visit any RGB color picker on the internet, like [this one](https://www.w3schools.com/colors/colors_rgb.asp) and check how <i>rgb(20,20,20)</i> looks like. Another peak is around (155,160,170) - solid gray - fragment of the wall (upper right corner). Evertyhing between those two peaks is hair of the dog, The fur is not entirely uniform - it contains many shades, so there is no single peak, but rather a wide range of colors similar to silver.

0.299 ‚àô Red + 0.587 ‚àô Green + 0.114 ‚àô Blue

Where by Red, Green , Blue we mean pixel in given <i>i,j,k</i> position. Please note that resuliting pixel will also have max value of 255 

lorem ipsum.